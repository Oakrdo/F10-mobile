-- Farm Autom√°tico Q - Orthodox, Demonic, Bags e Coins (CORRIGIDO)
local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local VirtualInputManager = game:GetService("VirtualInputManager")

-- Configura√ß√µes
local PREFER_INNER = true
local FARM_TYPE = "Orthodox"  -- "Orthodox", "Demonic" ou "Ambos"
local COLLECT_BAGS = true     -- Ativar coleta de bags
local ATTACK_INTERVAL = 0.3
local MAX_ATTACKS = 12
local TELEPORT_DISTANCE = 5
local BAG_COLLECT_TIME = 2    -- Tempo para segurar E nas bags

-- Estados
local isFarming = false
local currentTarget = nil

-- Interface Mobile
local gui = Instance.new("ScreenGui")
gui.Name = "AutoFarmGUI"
gui.Parent = player:WaitForChild("PlayerGui")
gui.ResetOnSpawn = false

local container = Instance.new("Frame")
container.Size = UDim2.new(0, 240, 0, 220)
container.Position = UDim2.new(0.05, 0, 0.15, 0)
container.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
container.BackgroundTransparency = 0.2

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = container

-- Barra de t√≠tulo
local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 35)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(52, 152, 219)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(0.7, 0, 1, 0)
title.Position = UDim2.new(0, 10, 0, 0)
title.Text = "ü§ñ Q AUTO COMPLETO"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = titleBar

local minimizeBtn = Instance.new("TextButton")
minimizeBtn.Name = "MinimizeBtn"
minimizeBtn.Size = UDim2.new(0, 35, 0, 35)
minimizeBtn.Position = UDim2.new(1, -35, 0, 0)
minimizeBtn.Text = "‚îÄ"
minimizeBtn.BackgroundColor3 = Color3.fromRGB(41, 128, 185)
minimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeBtn.Font = Enum.Font.GothamBold
minimizeBtn.TextSize = 18
minimizeBtn.Parent = titleBar

titleBar.Parent = container

-- Conte√∫do
local content = Instance.new("Frame")
content.Name = "Content"
content.Size = UDim2.new(1, 0, 1, -35)
content.Position = UDim2.new(0, 0, 0, 35)
content.BackgroundTransparency = 1
content.Parent = container

-- Bot√£o de farm
local farmBtn = Instance.new("TextButton")
farmBtn.Name = "FarmButton"
farmBtn.Size = UDim2.new(0.9, 0, 0, 40)
farmBtn.Position = UDim2.new(0.05, 0, 0.02, 0)
farmBtn.Text = "‚ñ∂Ô∏è LIGAR FARM"
farmBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
farmBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
farmBtn.Font = Enum.Font.GothamBold
farmBtn.TextSize = 14

local farmCorner = Instance.new("UICorner")
farmCorner.CornerRadius = UDim.new(0, 8)
farmCorner.Parent = farmBtn

-- Status
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0.9, 0, 0, 40)
statusLabel.Position = UDim2.new(0.05, 0, 0.25, 0)
statusLabel.Text = "Status: Parado"
statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
statusLabel.BackgroundTransparency = 1
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 11
statusLabel.TextWrapped = true

-- Configura√ß√µes - Linha 1: Tipo de NPC
local configFrame1 = Instance.new("Frame")
configFrame1.Size = UDim2.new(0.9, 0, 0, 25)
configFrame1.Position = UDim2.new(0.05, 0, 0.5, 0)
configFrame1.BackgroundTransparency = 1

local typeLabel = Instance.new("TextLabel")
typeLabel.Size = UDim2.new(0.6, 0, 1, 0)
typeLabel.Text = "NPCs: ORTHODOX"
typeLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
typeLabel.BackgroundTransparency = 1
typeLabel.Font = Enum.Font.Gotham
typeLabel.TextSize = 11
typeLabel.TextXAlignment = Enum.TextXAlignment.Left

local typeToggleBtn = Instance.new("TextButton")
typeToggleBtn.Size = UDim2.new(0.35, 0, 1, 0)
typeToggleBtn.Position = UDim2.new(0.65, 0, 0, 0)
typeToggleBtn.Text = "TROCAR"
typeToggleBtn.BackgroundColor3 = Color3.fromRGB(155, 89, 182)
typeToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
typeToggleBtn.Font = Enum.Font.Gotham
typeToggleBtn.TextSize = 10

-- Configura√ß√µes - Linha 2: Prioridade Inner
local configFrame2 = Instance.new("Frame")
configFrame2.Size = UDim2.new(0.9, 0, 0, 25)
configFrame2.Position = UDim2.new(0.05, 0, 0.65, 0)
configFrame2.BackgroundTransparency = 1

local preferLabel = Instance.new("TextLabel")
preferLabel.Size = UDim2.new(0.6, 0, 1, 0)
preferLabel.Text = "Priorizar Inner: SIM"
preferLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
preferLabel.BackgroundTransparency = 1
preferLabel.Font = Enum.Font.Gotham
preferLabel.TextSize = 11
preferLabel.TextXAlignment = Enum.TextXAlignment.Left

local innerToggleBtn = Instance.new("TextButton")
innerToggleBtn.Size = UDim2.new(0.35, 0, 1, 0)
innerToggleBtn.Position = UDim2.new(0.65, 0, 0, 0)
innerToggleBtn.Text = "ALTERAR"
innerToggleBtn.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
innerToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
innerToggleBtn.Font = Enum.Font.Gotham
innerToggleBtn.TextSize = 10

-- Configura√ß√µes - Linha 3: Coleta de Bags
local configFrame3 = Instance.new("Frame")
configFrame3.Size = UDim2.new(0.9, 0, 0, 25)
configFrame3.Position = UDim2.new(0.05, 0, 0.8, 0)
configFrame3.BackgroundTransparency = 1

local bagLabel = Instance.new("TextLabel")
bagLabel.Size = UDim2.new(0.6, 0, 1, 0)
bagLabel.Text = "Coletar Bags: SIM"
bagLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
bagLabel.BackgroundTransparency = 1
bagLabel.Font = Enum.Font.Gotham
bagLabel.TextSize = 11
bagLabel.TextXAlignment = Enum.TextXAlignment.Left

local bagToggleBtn = Instance.new("TextButton")
bagToggleBtn.Size = UDim2.new(0.35, 0, 1, 0)
bagToggleBtn.Position = UDim2.new(0.65, 0, 0, 0)
bagToggleBtn.Text = "ALTERAR"
bagToggleBtn.BackgroundColor3 = Color3.fromRGB(241, 196, 15)
bagToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
bagToggleBtn.Font = Enum.Font.Gotham
bagToggleBtn.TextSize = 10

-- Adicionar √† interface
farmBtn.Parent = content
statusLabel.Parent = content

typeLabel.Parent = configFrame1
typeToggleBtn.Parent = configFrame1
configFrame1.Parent = content

preferLabel.Parent = configFrame2
innerToggleBtn.Parent = configFrame2
configFrame2.Parent = content

bagLabel.Parent = configFrame3
bagToggleBtn.Parent = configFrame3
configFrame3.Parent = content

-- Sistema de arrasto
local dragging = false
local dragStart = nil
local startPos = nil

titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = container.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.Touch then
        local delta = input.Position - dragStart
        local newX = math.clamp(
            startPos.X.Offset + delta.X,
            0,
            gui.AbsoluteSize.X - container.AbsoluteSize.X
        )
        local newY = math.clamp(
            startPos.Y.Offset + delta.Y,
            0,
            gui.AbsoluteSize.Y - container.AbsoluteSize.Y
        )
        container.Position = UDim2.new(0, newX, 0, newY)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

-- Sistema de minimizar
local isMinimized = false
local originalSize = container.Size
local minimizedSize = UDim2.new(0, 240, 0, 35)

minimizeBtn.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    if isMinimized then
        content.Visible = false
        container.Size = minimizedSize
        minimizeBtn.Text = "‚ñ°"
        minimizeBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
    else
        content.Visible = true
        container.Size = originalSize
        minimizeBtn.Text = "‚îÄ"
        minimizeBtn.BackgroundColor3 = Color3.fromRGB(41, 128, 185)
    end
end)

-- Fun√ß√µes de busca
local function findNPCs()
    local npcs = {}
    
    -- Nomes dos NPCs baseados no tipo selecionado
    local npcNames = {}
    
    if FARM_TYPE == "Orthodox" then
        npcNames = {
            "Outer Orthodox Disciple",
            "Inner Orthodox Disciple"
        }
    elseif FARM_TYPE == "Demonic" then
        npcNames = {
            "Outer Demonic Disciple", 
            "Inner Demonic Disciple"
        }
    elseif FARM_TYPE == "Ambos" then
        npcNames = {
            "Outer Orthodox Disciple",
            "Inner Orthodox Disciple",
            "Outer Demonic Disciple", 
            "Inner Demonic Disciple"
        }
    end
    
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Model") then
            local name = obj.Name
            for _, npcName in pairs(npcNames) do
                if name == npcName then
                    local humanoid = obj:FindFirstChild("Humanoid")
                    local rootPart = obj:FindFirstChild("HumanoidRootPart")
                    if humanoid and rootPart and humanoid.Health > 0 then
                        table.insert(npcs, {
                            Model = obj,
                            Name = name,
                            IsInner = name:find("Inner") ~= nil,
                            IsDemonic = name:find("Demonic") ~= nil,
                            Position = rootPart.Position,
                            Humanoid = humanoid,
                            RootPart = rootPart
                        })
                    end
                    break
                end
            end
        end
    end
    return npcs
end

local function findBags()
    if not COLLECT_BAGS then return {} end
    
    local bags = {}
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Model") and obj.Name:lower():find("bag") then
            local rootPart = obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
            if rootPart then
                table.insert(bags, {
                    Model = obj,
                    Name = obj.Name,
                    Position = rootPart.Position
                })
            end
        end
    end
    return bags
end

local function findCoins()
    local coins = {}
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Part") and obj.Name:lower():find("coin") then
            table.insert(coins, {
                Part = obj,
                Position = obj.Position
            })
        end
    end
    return coins
end

local function calculateDistance(pos1, pos2)
    return (pos1 - pos2).Magnitude
end

local function teleportTo(position)
    local character = player.Character
    if not character then return false end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return false end
    
    hrp.CFrame = CFrame.new(position + Vector3.new(0, 3, 0))
    return true
end

-- Fun√ß√£o para pressionar Q
local function pressQ()
    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Q, false, nil)
    task.wait(0.05)
    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Q, false, nil)
    return true
end

-- Fun√ß√£o para segurar E (para coletar bags)
local function holdE(seconds)
    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, nil)
    task.wait(seconds)
    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, nil)
    return true
end

-- Fun√ß√£o para atacar NPC com Q
local function attackNPC(npc)
    if not npc then return false end
    
    print("‚öîÔ∏è Atacando " .. npc.Name)
    
    local character = player.Character
    if not character then return false end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return false end
    
    -- Teleportar pr√≥ximo ao NPC
    local teleportPos = npc.RootPart.CFrame * CFrame.new(0, 0, -TELEPORT_DISTANCE)
    hrp.CFrame = teleportPos * CFrame.new(0, 3, 0)
    
    task.wait(0.3)
    
    -- Olhar para o NPC
    hrp.CFrame = CFrame.new(hrp.Position, npc.RootPart.Position)
    
    -- Atacar com Q
    local attackCount = 0
    local qCount = 0
    
    while attackCount < MAX_ATTACKS and isFarming and npc.Humanoid.Health > 0 do
        statusLabel.Text = string.format("‚öîÔ∏è %s\nQ: %d/%d", npc.Name, qCount + 1, MAX_ATTACKS)
        
        -- Pressionar Q
        pressQ()
        qCount = qCount + 1
        
        -- Mover em c√≠rculo
        local angle = math.rad(attackCount * 45)
        local circlePos = npc.RootPart.CFrame * CFrame.new(
            math.cos(angle) * TELEPORT_DISTANCE,
            3,
            math.sin(angle) * TELEPORT_DISTANCE
        )
        hrp.CFrame = circlePos
        
        -- Olhar para NPC
        hrp.CFrame = CFrame.new(hrp.Position, npc.RootPart.Position)
        
        attackCount = attackCount + 1
        
        -- Verificar se NPC morreu
        if npc.Humanoid.Health <= 0 then
            print("‚úÖ " .. npc.Name .. " derrotado!")
            statusLabel.Text = "‚úÖ " .. npc.Name .. " derrotado!"
            break
        end
        
        task.wait(ATTACK_INTERVAL)
    end
    
    return qCount > 0
end

-- Fun√ß√£o para coletar Bag
local function collectBag(bag)
    if not bag then return false end
    
    print("üéí Coletando " .. bag.Name)
    statusLabel.Text = "üéí Coletando Bag..."
    
    -- Teleportar para a bag
    teleportTo(bag.Position)
    task.wait(0.5)
    
    -- Tentar diferentes m√©todos para coletar bag
    local collected = false
    
    -- M√©todo 1: Procurar ProximityPrompt
    for _, child in pairs(bag.Model:GetDescendants()) do
        if child:IsA("ProximityPrompt") then
            pcall(function()
                child.Enabled = true
                child:InputHoldBegin()
                task.wait(BAG_COLLECT_TIME)
                child:InputHoldEnd()
                collected = true
            end)
            break
        end
    end
    
    -- M√©todo 2: Segurar E
    if not collected then
        print("üéÆ Segurando E para pegar bag...")
        holdE(BAG_COLLECT_TIME)
        task.wait(0.5)
    end
    
    -- M√©todo 3: Tentar destruir (√∫ltimo recurso)
    if bag.Model and bag.Model.Parent then
        pcall(function()
            bag.Model:Destroy()
            collected = true
        end)
    end
    
    if collected then
        print("‚úÖ Bag coletada!")
        statusLabel.Text = "‚úÖ Bag coletada!"
    else
        print("‚ö†Ô∏è N√£o consegui coletar a bag")
        statusLabel.Text = "‚ö†Ô∏è Bag n√£o coletada"
    end
    
    task.wait(1)
    return collected
end

-- Fun√ß√£o para coletar Coin
local function collectCoin(coin)
    if not coin then return false end
    
    statusLabel.Text = "üí∞ Coletando Coin..."
    teleportTo(coin.Position)
    task.wait(0.3)
    
    -- Pressionar Q para pegar coin
    pressQ()
    
    task.wait(0.5)
    return true
end

local function getBestTarget()
    local character = player.Character
    if not character then return nil end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return nil end
    
    local playerPos = hrp.Position
    
    -- Bags primeiro (se ativado)
    if COLLECT_BAGS then
        local bags = findBags()
        if #bags > 0 then
            local closestBag = nil
            local closestDist = 9999
            
            for _, bag in pairs(bags) do
                local dist = calculateDistance(playerPos, bag.Position)
                if dist < closestDist and dist < 50 then
                    closestDist = dist
                    closestBag = bag
                end
            end
            
            if closestBag then
                return {Type = "Bag", Object = closestBag, Distance = closestDist}
            end
        end
    end
    
    -- Coins
    local coins = findCoins()
    if #coins > 0 then
        local closestCoin = nil
        local closestDist = 9999
        
        for _, coin in pairs(coins) do
            local dist = calculateDistance(playerPos, coin.Position)
            if dist < closestDist and dist < 30 then
                closestDist = dist
                closestCoin = coin
            end
        end
        
        if closestCoin then
            return {Type = "Coin", Object = closestCoin, Distance = closestDist}
        end
    end
    
    -- NPCs
    local npcs = findNPCs()
    if #npcs == 0 then return nil end
    
    -- Calcular dist√¢ncias
    for _, npc in pairs(npcs) do
        npc.Distance = calculateDistance(playerPos, npc.Position)
    end
    
    -- Ordenar por prioridade
    table.sort(npcs, function(a, b)
        if PREFER_INNER then
            if a.IsInner and not b.IsInner then
                return true
            elseif not a.IsInner and b.IsInner then
                return false
            else
                return a.Distance < b.Distance
            end
        else
            return a.Distance < b.Distance
        end
    end)
    
    local bestNPC = npcs[1]
    if bestNPC.Distance < 100 then
        return {Type = "NPC", Object = bestNPC, Distance = bestNPC.Distance}
    end
    
    return nil
end

-- Loop principal de farm
local function farmLoop()
    while isFarming do
        local target = getBestTarget()
        
        if target then
            if target.Type == "NPC" then
                currentTarget = target.Object.Name
                attackNPC(target.Object)
                task.wait(0.5)
                
            elseif target.Type == "Bag" then
                currentTarget = "Bag"
                collectBag(target.Object)
                task.wait(1)
                
            elseif target.Type == "Coin" then
                currentTarget = "Coin"
                collectCoin(target.Object)
                task.wait(0.5)
            end
            
        else
            statusLabel.Text = string.format("üîç Procurando %s...", FARM_TYPE)
            task.wait(2)
        end
    end
end

-- Controlador principal
farmBtn.MouseButton1Click:Connect(function()
    isFarming = not isFarming
    
    if isFarming then
        farmBtn.Text = "‚è∏Ô∏è PARAR FARM"
        farmBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
        statusLabel.Text = string.format("ü§ñ FARM LIGADO\nNPCs: %s | Bags: %s", 
            FARM_TYPE, COLLECT_BAGS and "SIM" or "N√ÉO")
        
        task.spawn(farmLoop)
        
        print("üéÆ FARM LIGADO!")
        print("‚öîÔ∏è NPCs: " .. FARM_TYPE)
        print("üéí Bags: " .. (COLLECT_BAGS and "SIM" or "N√ÉO"))
        
    else
        farmBtn.Text = "‚ñ∂Ô∏è LIGAR FARM"
        farmBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
        statusLabel.Text = "Status: Parado"
        currentTarget = nil
        
        print("üéÆ FARM DESLIGADO!")
    end
end)

-- Bot√£o para trocar tipo de NPC
typeToggleBtn.MouseButton1Click:Connect(function()
    if FARM_TYPE == "Orthodox" then
        FARM_TYPE = "Demonic"
        typeLabel.Text = "NPCs: DEMONIC"
        typeToggleBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
    elseif FARM_TYPE == "Demonic" then
        FARM_TYPE = "Ambos"
        typeLabel.Text = "NPCs: AMBOS"
        typeToggleBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)
    else
        FARM_TYPE = "Orthodox"
        typeLabel.Text = "NPCs: ORTHODOX"
        typeToggleBtn.BackgroundColor3 = Color3.fromRGB(155, 89, 182)
    end
    
    print("üéØ NPCs alterado para: " .. FARM_TYPE)
    
    if isFarming then
        statusLabel.Text = string.format("ü§ñ FARM LIGADO\nNPCs: %s | Bags: %s", 
            FARM_TYPE, COLLECT_BAGS and "SIM" or "N√ÉO")
    end
end)

-- Bot√£o para alternar Inner/Outer prioridade
innerToggleBtn.MouseButton1Click:Connect(function()
    PREFER_INNER = not PREFER_INNER
    preferLabel.Text = "Priorizar Inner: " .. (PREFER_INNER and "SIM" or "N√ÉO")
    print("‚öôÔ∏è Prioridade Inner: " .. (PREFER_INNER and "Ativada" or "Desativada"))
end)

-- Bot√£o para alternar coleta de Bags
bagToggleBtn.MouseButton1Click:Connect(function()
    COLLECT_BAGS = not COLLECT_BAGS
    bagLabel.Text = "Coletar Bags: " .. (COLLECT_BAGS and "SIM" or "N√ÉO")
    
    if COLLECT_BAGS then
        bagToggleBtn.BackgroundColor3 = Color3.fromRGB(241, 196, 15)
    else
        bagToggleBtn.BackgroundColor3 = Color3.fromRGB(149, 165, 166)
    end
    
    print("üéí Coleta de Bags: " .. (COLLECT_BAGS and "Ativada" or "Desativada"))
    
    if isFarming then
        statusLabel.Text = string.format("ü§ñ FARM LIGADO\nNPCs: %s | Bags: %s", 
            FARM_TYPE, COLLECT_BAGS and "SIM" or "N√ÉO")
    end
end)

-- Bot√£o de teste Q
local testBtn = Instance.new("TextButton")
testBtn.Size = UDim2.new(0.3, 0, 0, 25)
testBtn.Position = UDim2.new(0.7, 0, 0, 5)
testBtn.Text = "TESTE Q"
testBtn.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
testBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
testBtn.Font = Enum.Font.Gotham
testBtn.TextSize = 10
testBtn.Parent = titleBar

testBtn.MouseButton1Click:Connect(function()
    print("üß™ Testando Q...")
    pressQ()
    statusLabel.Text = "üß™ Q testado!"
    task.wait(1)
    if isFarming then
        statusLabel.Text = string.format("ü§ñ FARM LIGADO\nNPCs: %s | Bags: %s", 
            FARM_TYPE, COLLECT_BAGS and "SIM" or "N√ÉO")
    else
        statusLabel.Text = "Status: Parado"
    end
end)

-- Bot√£o de teste E (para bags)
local testEBtn = Instance.new("TextButton")
testEBtn.Size = UDim2.new(0.3, 0, 0, 25)
testEBtn.Position = UDim2.new(0.35, 0, 0, 5)
testEBtn.Text = "TESTE E"
testEBtn.BackgroundColor3 = Color3.fromRGB(155, 89, 182)
testEBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
testEBtn.Font = Enum.Font.Gotham
testEBtn.TextSize = 10
testEBtn.Parent = titleBar

testEBtn.MouseButton1Click:Connect(function()
    print("üß™ Testando E...")
    holdE(1)
    statusLabel.Text = "üß™ E testado!"
    task.wait(1)
    if isFarming then
        statusLabel.Text = string.format("ü§ñ FARM LIGADO\nNPCs: %s | Bags: %s", 
            FARM_TYPE, COLLECT_BAGS and "SIM" or "N√ÉO")
    else
        statusLabel.Text = "Status: Parado"
    end
end)

container.Parent = gui

-- Sistema para garantir que GUI n√£o suma ao morrer
player.CharacterAdded:Connect(function()
    print("üîÑ Personagem renasceu - GUI mantida")
end)

print("‚úÖ SISTEMA COMPLETO CARREGADO!")
print("üéÆ CONFIGURA√á√ïES:")
print("   ‚Ä¢ NPCs: Orthodox, Demonic ou Ambos")
print("   ‚Ä¢ üéí Coleta de Bags: Ativada")
print("   ‚Ä¢ ‚öôÔ∏è Prioridade Inner: Ativada")
print("")
print("üì± CONTROLES:")
print("   ‚ñ∂Ô∏è LIGAR FARM - Liga/desliga tudo")
print("   üéØ TROCAR - Alterna NPCs (3 op√ß√µes)")
print("   ‚öôÔ∏è ALTERAR - Prioridade Inner/Outer")
print("   üéí ALTERAR - Liga/desliga Bags")
print("   üß™ TESTE Q - Testa ataque")
print("   üß™ TESTE E - Testa coleta de bags")
print("   üëÜ Arraste - Move interface")
print("   ‚îÄ/‚ñ° - Minimiza/maximiza")
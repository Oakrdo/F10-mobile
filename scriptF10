--[[
    EXPLORER MOBILE PARA ROBLOX
    Funcionalidades:
    ‚úÖ Navega√ß√£o completa da √°rvore do Workspace
    ‚úÖ Visualizar propriedades de objetos
    ‚úÖ Expandir/colapsar hierarquia
    ‚úÖ Buscar objetos por nome
    ‚úÖ Interface mobile otimizada
]]

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TextService = game:GetService("TextService")

-- Configura√ß√µes
local PLAYER = Players.LocalPlayer
local screenGui = nil
local isExplorerVisible = false

-- Vari√°veis
local selectedObject = nil
local expandedObjects = {}
local objectIcons = {
    Folder = "üìÅ",
    Part = "üß±", 
    MeshPart = "üî∑",
    Script = "üìú",
    LocalScript = "üìú",
    ModuleScript = "üì¶",
    Sound = "üîä",
    Model = "üì¶",
    Camera = "üì∑",
    Light = "üí°",
    Decal = "üñºÔ∏è",
    Texture = "üé®",
    Humanoid = "üë§",
    HumanoidRootPart = "üéØ",
    Motor6D = "‚öôÔ∏è",
    Fire = "üî•",
    Smoke = "üí®",
    Sparkles = "‚ú®",
    ParticleEmitter = "üåü"
}

-- Fun√ß√£o para obter √≠cone do objeto
local function GetObjectIcon(object)
    local className = object.ClassName
    return objectIcons[className] or "üìÑ"
end

-- Fun√ß√£o para criar item da √°rvore
local function CreateTreeItem(object, depth, parentFrame)
    local itemFrame = Instance.new("Frame")
    itemFrame.Size = UDim2.new(1, 0, 0, 25)
    itemFrame.BackgroundTransparency = 1
    itemFrame.Name = object.Name
    
    local indent = Instance.new("Frame")
    indent.Size = UDim2.new(0, depth * 20, 1, 0)
    indent.BackgroundTransparency = 1
    indent.Parent = itemFrame
    
    local expandButton = Instance.new("TextButton")
    expandButton.Size = UDim2.new(0, 20, 0, 20)
    expandButton.Position = UDim2.new(0, depth * 20, 0, 2)
    expandButton.Text = ""
    expandButton.BackgroundTransparency = 1
    expandButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    expandButton.TextSize = 12
    expandButton.Parent = itemFrame
    
    local iconLabel = Instance.new("TextLabel")
    iconLabel.Size = UDim2.new(0, 25, 0, 20)
    iconLabel.Position = UDim2.new(0, depth * 20 + 20, 0, 2)
    iconLabel.Text = GetObjectIcon(object)
    iconLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    iconLabel.BackgroundTransparency = 1
    iconLabel.TextSize = 14
    iconLabel.Parent = itemFrame
    
    local nameLabel = Instance.new("TextButton")
    nameLabel.Size = UDim2.new(1, - (depth * 20 + 50), 0, 20)
    nameLabel.Position = UDim2.new(0, depth * 20 + 45, 0, 2)
    nameLabel.Text = object.Name .. " (" .. object.ClassName .. ")"
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.BackgroundTransparency = 1
    nameLabel.TextSize = 12
    nameLabel.Parent = itemFrame
    
    -- Verificar se o objeto tem filhos
    local hasChildren = #object:GetChildren() > 0
    
    if hasChildren then
        if expandedObjects[object] then
            expandButton.Text = "‚ñº"
        else
            expandButton.Text = "‚ñ∂"
        end
    else
        expandButton.Text = "‚Ä¢"
        expandButton.TextColor3 = Color3.fromRGB(100, 100, 100)
    end
    
    -- Evento de expandir/colapsar
    expandButton.MouseButton1Click:Connect(function()
        if hasChildren then
            expandedObjects[object] = not expandedObjects[object]
            UpdateExplorerTree()
        end
    end)
    
    -- Evento de sele√ß√£o
    nameLabel.MouseButton1Click:Connect(function()
        selectedObject = object
        UpdatePropertiesPanel()
        UpdateExplorerTree()
    end)
    
    -- Destacar se selecionado
    if selectedObject == object then
        nameLabel.TextColor3 = Color3.fromRGB(0, 200, 255)
    end
    
    itemFrame.Parent = parentFrame
    
    -- Adicionar filhos se expandido
    if expandedObjects[object] and hasChildren then
        for _, child in ipairs(object:GetChildren()) do
            if not string.find(child.Name, "WildHorseESP") and child ~= screenGui then
                CreateTreeItem(child, depth + 1, parentFrame)
            end
        end
    end
end

-- Fun√ß√£o para atualizar a √°rvore do explorer
local function UpdateExplorerTree()
    if not screenGui then return end
    
    local explorerFrame = screenGui:FindFirstChild("ExplorerFrame")
    if not explorerFrame then return end
    
    local treeFrame = explorerFrame:FindFirstChild("TreeFrame")
    if not treeFrame then return end
    
    local treeContainer = treeFrame:FindFirstChild("TreeContainer")
    if not treeContainer then return end
    
    -- Limpar √°rvore anterior
    treeContainer:ClearAllChildren()
    
    -- Adicionar workspace
    CreateTreeItem(workspace, 0, treeContainer)
    
    -- Adicionar outros servi√ßos importantes
    local services = {
        game:GetService("Lighting"),
        game:GetService("ReplicatedStorage"),
        game:GetService("StarterPack"),
        game:GetService("StarterGui"),
        game:GetService("StarterPlayer")
    }
    
    for _, service in ipairs(services) do
        CreateTreeItem(service, 0, treeContainer)
    end
    
    -- Ajustar tamanho do container
    local totalHeight = #treeContainer:GetChildren() * 25
    treeContainer.Size = UDim2.new(1, 0, 0, totalHeight)
end

-- Fun√ß√£o para atualizar painel de propriedades
local function UpdatePropertiesPanel()
    if not screenGui then return end
    
    local explorerFrame = screenGui:FindFirstChild("ExplorerFrame")
    if not explorerFrame then return end
    
    local propsFrame = explorerFrame:FindFirstChild("PropertiesFrame")
    if not propsFrame then return end
    
    local propsContainer = propsFrame:FindFirstChild("PropsContainer")
    if not propsContainer then return end
    
    -- Limpar propriedades anteriores
    propsContainer:ClearAllChildren()
    
    if not selectedObject then
        local noSelection = Instance.new("TextLabel")
        noSelection.Size = UDim2.new(1, 0, 1, 0)
        noSelection.Text = "Nenhum objeto selecionado"
        noSelection.TextColor3 = Color3.fromRGB(150, 150, 150)
        noSelection.BackgroundTransparency = 1
        noSelection.TextSize = 14
        noSelection.Parent = propsContainer
        return
    end
    
    -- T√≠tulo das propriedades
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 30)
    title.Text = "Propriedades: " .. selectedObject.Name
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    title.TextSize = 14
    title.Font = Enum.Font.SourceSansBold
    title.Parent = propsContainer
    
    local yOffset = 35
    
    -- Propriedades b√°sicas
    local basicProps = {
        {"Nome", selectedObject.Name},
        {"Classe", selectedObject.ClassName},
        {"Arquiv√°vel", tostring(selectedObject.Archivable)}
    }
    
    for _, prop in ipairs(basicProps) do
        local propFrame = Instance.new("Frame")
        propFrame.Size = UDim2.new(1, -10, 0, 20)
        propFrame.Position = UDim2.new(0, 5, 0, yOffset)
        propFrame.BackgroundTransparency = 1
        propFrame.Parent = propsContainer
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(0.4, 0, 1, 0)
        nameLabel.Text = prop[1] .. ":"
        nameLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        nameLabel.TextXAlignment = Enum.TextXAlignment.Left
        nameLabel.BackgroundTransparency = 1
        nameLabel.TextSize = 12
        nameLabel.Parent = propFrame
        
        local valueLabel = Instance.new("TextLabel")
        valueLabel.Size = UDim2.new(0.6, 0, 1, 0)
        valueLabel.Position = UDim2.new(0.4, 0, 0, 0)
        valueLabel.Text = tostring(prop[2])
        valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        valueLabel.TextXAlignment = Enum.TextXAlignment.Left
        valueLabel.BackgroundTransparency = 1
        valueLabel.TextSize = 12
        valueLabel.Parent = propFrame
        
        yOffset = yOffset + 25
    end
    
    -- Propriedades espec√≠ficas por classe
    if selectedObject:IsA("BasePart") then
        local partProps = {
            {"Posi√ß√£o", tostring(selectedObject.Position)},
            {"Tamanho", tostring(selectedObject.Size)},
            {"Cor", tostring(selectedObject.Color)},
            {"Material", tostring(selectedObject.Material)}
        }
        
        for _, prop in ipairs(partProps) do
            local propFrame = Instance.new("Frame")
            propFrame.Size = UDim2.new(1, -10, 0, 20)
            propFrame.Position = UDim2.new(0, 5, 0, yOffset)
            propFrame.BackgroundTransparency = 1
            propFrame.Parent = propsContainer
            
            local nameLabel = Instance.new("TextLabel")
            nameLabel.Size = UDim2.new(0.4, 0, 1, 0)
            nameLabel.Text = prop[1] .. ":"
            nameLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
            nameLabel.TextXAlignment = Enum.TextXAlignment.Left
            nameLabel.BackgroundTransparency = 1
            nameLabel.TextSize = 12
            nameLabel.Parent = propFrame
            
            local valueLabel = Instance.new("TextLabel")
            valueLabel.Size = UDim2.new(0.6, 0, 1, 0)
            valueLabel.Position = UDim2.new(0.4, 0, 0, 0)
            valueLabel.Text = prop[2]
            valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            valueLabel.TextXAlignment = Enum.TextXAlignment.Left
            valueLabel.BackgroundTransparency = 1
            valueLabel.TextSize = 12
            valueLabel.Parent = propFrame
            
            yOffset = yOffset + 25
        end
    end
    
    -- Ajustar tamanho do container
    propsContainer.Size = UDim2.new(1, 0, 0, yOffset + 10)
end

-- Fun√ß√£o para criar a interface do explorer
local function CreateExplorerUI()
    if screenGui and screenGui.Parent then
        screenGui:Destroy()
    end
    
    screenGui = Instance.new("ScreenGui")
    screenGui.Name = "MobileExplorer"
    screenGui.Parent = PLAYER:WaitForChild("PlayerGui")
    screenGui.ResetOnSpawn = false
    
    -- Bot√£o flutuante para abrir/fechar
    local toggleButton = Instance.new("TextButton")
    toggleButton.Name = "ToggleButton"
    toggleButton.Size = UDim2.new(0, 60, 0, 40)
    toggleButton.Position = UDim2.new(1, -70, 0, 60)
    toggleButton.AnchorPoint = Vector2.new(1, 0)
    toggleButton.Text = "üìÅ F10"
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    toggleButton.BackgroundTransparency = 0.3
    toggleButton.TextSize = 14
    toggleButton.ZIndex = 10
    toggleButton.Parent = screenGui
    
    -- Frame principal do explorer
    local explorerFrame = Instance.new("Frame")
    explorerFrame.Name = "ExplorerFrame"
    explorerFrame.Size = UDim2.new(0.9, 0, 0.8, 0)
    explorerFrame.Position = UDim2.new(0.05, 0, 0.1, 0)
    explorerFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    explorerFrame.BackgroundTransparency = 0.1
    explorerFrame.Visible = false
    explorerFrame.ZIndex = 5
    explorerFrame.Parent = screenGui
    
    -- Barra de t√≠tulo
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 30)
    titleBar.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
    titleBar.BorderSizePixel = 0
    titleBar.ZIndex = 6
    titleBar.Parent = explorerFrame
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -80, 1, 0)
    titleLabel.Position = UDim2.new(0, 5, 0, 0)
    titleLabel.Text = "EXPLORER (F10 Mobile)"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextSize = 14
    titleLabel.Font = Enum.Font.SourceSansBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.ZIndex = 7
    titleLabel.Parent = titleBar
    
    -- Bot√£o de fechar
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0, 0)
    closeButton.Text = "X"
    closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
    closeButton.TextSize = 14
    closeButton.ZIndex = 7
    closeButton.Parent = titleBar
    
    -- Bot√£o de refresh
    local refreshButton = Instance.new("TextButton")
    refreshButton.Name = "RefreshButton"
    refreshButton.Size = UDim2.new(0, 40, 0, 30)
    refreshButton.Position = UDim2.new(1, -80, 0, 0)
    refreshButton.Text = "üîÑ"
    refreshButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    refreshButton.BackgroundColor3 = Color3.fromRGB(80, 80, 120)
    refreshButton.TextSize = 14
    refreshButton.ZIndex = 7
    refreshButton.Parent = titleBar
    
    -- Divis√£o entre √°rvore e propriedades
    local splitter = Instance.new("Frame")
    splitter.Size = UDim2.new(1, 0, 0, 5)
    splitter.Position = UDim2.new(0, 0, 0, 30)
    splitter.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    splitter.ZIndex = 6
    splitter.Parent = explorerFrame
    
    -- Frame da √°rvore (esquerda)
    local treeFrame = Instance.new("Frame")
    treeFrame.Name = "TreeFrame"
    treeFrame.Size = UDim2.new(0.5, -2, 1, -35)
    treeFrame.Position = UDim2.new(0, 0, 0, 35)
    treeFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    treeFrame.ZIndex = 6
    treeFrame.Parent = explorerFrame
    
    local treeScroll = Instance.new("ScrollingFrame")
    treeScroll.Size = UDim2.new(1, 0, 1, 0)
    treeScroll.BackgroundTransparency = 1
    treeScroll.ScrollBarThickness = 8
    treeScroll.ZIndex = 6
    treeScroll.Parent = treeFrame
    
    local treeContainer = Instance.new("Frame")
    treeContainer.Name = "TreeContainer"
    treeContainer.Size = UDim2.new(1, 0, 0, 0)
    treeContainer.BackgroundTransparency = 1
    treeContainer.ZIndex = 6
    treeContainer.Parent = treeScroll
    
    -- Frame das propriedades (direita)
    local propsFrame = Instance.new("Frame")
    propsFrame.Name = "PropertiesFrame"
    propsFrame.Size = UDim2.new(0.5, -2, 1, -35)
    propsFrame.Position = UDim2.new(0.5, 2, 0, 35)
    propsFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    propsFrame.ZIndex = 6
    propsFrame.Parent = explorerFrame
    
    local propsScroll = Instance.new("ScrollingFrame")
    propsScroll.Size = UDim2.new(1, 0, 1, 0)
    propsScroll.BackgroundTransparency = 1
    propsScroll.ScrollBarThickness = 8
    propsScroll.ZIndex = 6
    propsScroll.Parent = propsFrame
    
    local propsContainer = Instance.new("Frame")
    propsContainer.Name = "PropsContainer"
    propsContainer.Size = UDim2.new(1, 0, 0, 0)
    propsContainer.BackgroundTransparency = 1
    propsContainer.ZIndex = 6
    propsContainer.Parent = propsScroll
    
    -- Conex√µes dos bot√µes
    toggleButton.MouseButton1Click:Connect(function()
        isExplorerVisible = not isExplorerVisible
        explorerFrame.Visible = isExplorerVisible
        
        if isExplorerVisible then
            UpdateExplorerTree()
            toggleButton.Text = "üìÅ ON"
        else
            toggleButton.Text = "üìÅ F10"
        end
    end)
    
    closeButton.MouseButton1Click:Connect(function()
        isExplorerVisible = false
        explorerFrame.Visible = false
        toggleButton.Text = "üìÅ F10"
    end)
    
    refreshButton.MouseButton1Click:Connect(function()
        UpdateExplorerTree()
        if selectedObject then
            UpdatePropertiesPanel()
        end
    end)
    
    return screenGui
end

-- Inicializa√ß√£o
CreateExplorerUI()

-- Expandir workspace por padr√£o
expandedObjects[workspace] = true

print("üìÅ Explorer Mobile ativado!")
print("Clique em 'üìÅ F10' para abrir o explorer")
print("Use ‚ñ∂/‚ñº para expandir/colapsar a √°rvore")
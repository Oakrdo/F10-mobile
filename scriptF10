--[[
    EXPLORER MOBILE CORRIGIDO
    Folders funcionais + Letras amarelas brilhantes
]]

local Players = game:GetService("Players")
local PLAYER = Players.LocalPlayer

-- Vari√°veis
local expandedFolders = {}
local screenGui = nil

-- Criar a interface
screenGui = Instance.new("ScreenGui")
screenGui.Name = "MobileExplorer"
screenGui.Parent = PLAYER:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false

-- Bot√£o para abrir/fechar
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 90, 0, 45)
toggleButton.Position = UDim2.new(1, -100, 0, 10)
toggleButton.AnchorPoint = Vector2.new(1, 0)
toggleButton.Text = "üìÅ EXPLORER"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 0)  -- AMARELO BRILHANTE
toggleButton.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
toggleButton.BackgroundTransparency = 0.1
toggleButton.TextSize = 14
toggleButton.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
toggleButton.TextStrokeTransparency = 0.5
toggleButton.ZIndex = 10
toggleButton.Parent = screenGui

-- Frame principal
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0.95, 0, 0.85, 0)
mainFrame.Position = UDim2.new(0.025, 0, 0.075, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
mainFrame.BackgroundTransparency = 0.05
mainFrame.Visible = false
mainFrame.ZIndex = 5
mainFrame.Parent = screenGui

-- T√≠tulo
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 45)
title.Text = "üîç EXPLORER MOBILE"
title.TextColor3 = Color3.fromRGB(255, 255, 0)  -- AMARELO BRILHANTE
title.BackgroundColor3 = Color3.fromRGB(35, 35, 55)
title.TextSize = 18
title.Font = Enum.Font.SourceSansBold
title.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
title.TextStrokeTransparency = 0.3
title.Parent = mainFrame

-- √Årea de scroll
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(1, -10, 1, -100)
scrollFrame.Position = UDim2.new(0, 5, 0, 50)
scrollFrame.BackgroundTransparency = 1
scrollFrame.ScrollBarThickness = 10
scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(255, 255, 0)
scrollFrame.Parent = mainFrame

-- Container dos itens
local itemsContainer = Instance.new("Frame")
itemsContainer.Size = UDim2.new(1, 0, 0, 0)
itemsContainer.BackgroundTransparency = 1
itemsContainer.Parent = scrollFrame

-- Fun√ß√£o para obter √≠cone
local function GetIcon(className)
    local icons = {
        Folder = "üìÅ",
        Part = "üß±",
        MeshPart = "üî∑",
        Script = "üìú",
        Model = "üì¶",
        Sound = "üîä",
        Camera = "üì∑",
        Light = "üí°"
    }
    return icons[className] or "üìÑ"
end

-- Fun√ß√£o para adicionar item com clique
local function AddItem(object, depth, parent)
    local itemFrame = Instance.new("Frame")
    itemFrame.Size = UDim2.new(1, 0, 0, 30)
    itemFrame.BackgroundTransparency = 1
    itemFrame.Name = "Item_" .. object.Name
    
    -- Bot√£o de expandir (para folders)
    local expandButton = Instance.new("TextButton")
    expandButton.Size = UDim2.new(0, 25, 0, 25)
    expandButton.Position = UDim2.new(0, depth * 25, 0, 2)
    expandButton.BackgroundTransparency = 1
    expandButton.TextColor3 = Color3.fromRGB(255, 255, 0)
    expandButton.TextSize = 14
    expandButton.Parent = itemFrame
    
    -- √çcone
    local icon = Instance.new("TextLabel")
    icon.Size = UDim2.new(0, 25, 0, 25)
    icon.Position = UDim2.new(0, depth * 25 + 25, 0, 2)
    icon.Text = GetIcon(object.ClassName)
    icon.TextColor3 = Color3.fromRGB(255, 255, 0)  -- AMARELO BRILHANTE
    icon.BackgroundTransparency = 1
    icon.TextSize = 14
    icon.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    icon.TextStrokeTransparency = 0.3
    icon.Parent = itemFrame
    
    -- Nome do objeto
    local nameLabel = Instance.new("TextButton")
    nameLabel.Size = UDim2.new(1, -(depth * 25 + 60), 0, 25)
    nameLabel.Position = UDim2.new(0, depth * 25 + 55, 0, 2)
    nameLabel.Text = object.Name .. " (" .. object.ClassName .. ")"
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 0)  -- AMARELO BRILHANTE
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.BackgroundTransparency = 1
    nameLabel.TextSize = 12
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.TextStrokeTransparency = 0.4
    nameLabel.Parent = itemFrame
    
    -- Verificar se √© folder/expand√≠vel
    local hasChildren = #object:GetChildren() > 0
    local isExpanded = expandedFolders[object]
    
    if hasChildren then
        if isExpanded then
            expandButton.Text = "‚ñº"
        else
            expandButton.Text = "‚ñ∂"
        end
        
        -- Evento para expandir/colapsar
        expandButton.MouseButton1Click:Connect(function()
            expandedFolders[object] = not expandedFolders[object]
            PopulateExplorer()
        end)
    else
        expandButton.Text = "‚Ä¢"
        expandButton.TextColor3 = Color3.fromRGB(150, 150, 0)
    end
    
    -- Evento para selecionar item
    nameLabel.MouseButton1Click:Connect(function()
        print("üìå Selecionado: " .. object.Name .. " (" .. object.ClassName .. ")")
    end)
    
    itemFrame.Parent = parent
    return itemFrame
end

-- Fun√ß√£o para adicionar objetos recursivamente
local function AddObjects(parentObject, depth, parentContainer)
    local yPosition = 0
    
    for _, child in ipairs(parentObject:GetChildren()) do
        -- Pular alguns objetos para n√£o poluir
        if not child:IsA("Script") and not child:IsA("LocalScript") then
            local item = AddItem(child, depth, parentContainer)
            item.Position = UDim2.new(0, 0, 0, yPosition)
            yPosition = yPosition + 30
            
            -- Adicionar filhos se for folder expandido
            if expandedFolders[child] and #child:GetChildren() > 0 then
                yPosition = yPosition + AddObjects(child, depth + 1, parentContainer)
            end
        end
    end
    
    return yPosition
end

-- Fun√ß√£o para popular o explorer
local function PopulateExplorer()
    -- Limpar container
    itemsContainer:ClearAllChildren()
    
    local totalHeight = 0
    
    -- Adicionar Workspace
    local workspaceHeader = Instance.new("TextButton")
    workspaceHeader.Size = UDim2.new(1, 0, 0, 35)
    workspaceHeader.Position = UDim2.new(0, 0, 0, totalHeight)
    workspaceHeader.Text = "üéØ WORKSPACE (" .. #workspace:GetChildren() .. " objetos)"
    workspaceHeader.TextColor3 = Color3.fromRGB(255, 255, 0)
    workspaceHeader.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
    workspaceHeader.TextSize = 14
    workspaceHeader.Font = Enum.Font.SourceSansBold
    workspaceHeader.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    workspaceHeader.TextStrokeTransparency = 0.3
    workspaceHeader.Parent = itemsContainer
    
    -- Expandir/colapsar Workspace
    workspaceHeader.MouseButton1Click:Connect(function()
        expandedFolders[workspace] = not expandedFolders[workspace]
        PopulateExplorer()
    end)
    
    totalHeight = totalHeight + 35
    
    -- Adicionar objetos do Workspace se expandido
    if expandedFolders[workspace] then
        totalHeight = totalHeight + AddObjects(workspace, 0, itemsContainer)
    end
    
    -- Adicionar Lighting
    totalHeight = totalHeight + 10
    local lightingHeader = Instance.new("TextButton")
    lightingHeader.Size = UDim2.new(1, 0, 0, 35)
    lightingHeader.Position = UDim2.new(0, 0, 0, totalHeight)
    lightingHeader.Text = "üí° LIGHTING (" .. #game.Lighting:GetChildren() .. " objetos)"
    lightingHeader.TextColor3 = Color3.fromRGB(255, 255, 0)
    lightingHeader.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
    lightingHeader.TextSize = 14
    lightingHeader.Font = Enum.Font.SourceSansBold
    lightingHeader.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    lightingHeader.TextStrokeTransparency = 0.3
    lightingHeader.Parent = itemsContainer
    
    lightingHeader.MouseButton1Click:Connect(function()
        expandedFolders[game.Lighting] = not expandedFolders[game.Lighting]
        PopulateExplorer()
    end)
    
    totalHeight = totalHeight + 35
    
    -- Adicionar objetos do Lighting se expandido
    if expandedFolders[game.Lighting] then
        totalHeight = totalHeight + AddObjects(game.Lighting, 0, itemsContainer)
    end
    
    -- Ajustar tamanhos
    itemsContainer.Size = UDim2.new(1, 0, 0, totalHeight)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, totalHeight)
end

-- Bot√£o de atualizar
local refreshButton = Instance.new("TextButton")
refreshButton.Size = UDim2.new(0, 120, 0, 35)
refreshButton.Position = UDim2.new(0.5, -60, 1, -45)
refreshButton.Text = "üîÑ ATUALIZAR"
refreshButton.TextColor3 = Color3.fromRGB(255, 255, 0)
refreshButton.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
refreshButton.TextSize = 14
refreshButton.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
refreshButton.TextStrokeTransparency = 0.3
refreshButton.Parent = mainFrame

-- Bot√£o de fechar
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 120, 0, 35)
closeButton.Position = UDim2.new(0.5, -60, 1, -85)
closeButton.Text = "‚ùå FECHAR"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 0)
closeButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
closeButton.TextSize = 14
closeButton.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
closeButton.TextStrokeTransparency = 0.3
closeButton.Parent = mainFrame

-- Conex√µes dos bot√µes
toggleButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
    if mainFrame.Visible then
        PopulateExplorer()
        toggleButton.Text = "üìÅ ABERTO"
        toggleButton.TextColor3 = Color3.fromRGB(0, 255, 0)  -- Verde quando aberto
    else
        toggleButton.Text = "üìÅ EXPLORER"
        toggleButton.TextColor3 = Color3.fromRGB(255, 255, 0)  -- Amarelo quando fechado
    end
end)

refreshButton.MouseButton1Click:Connect(function()
    PopulateExplorer()
    print("üîÑ Explorer atualizado!")
end)

closeButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    toggleButton.Text = "üìÅ EXPLORER"
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 0)
end)

-- Expandir Workspace por padr√£o
expandedFolders[workspace] = true

print("üîç Explorer Mobile CARREGADO!")
print("üìÅ Clique em 'üìÅ EXPLORER' para abrir")
print("‚ñ∂ Use os bot√µes ‚ñ∂/‚ñº para expandir/colapsar folders")